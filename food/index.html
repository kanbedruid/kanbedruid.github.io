<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>饭店排名</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
:root {
  --bg: #0f0f10;
  --panel: #18181b;
  --grid: #2a2a2e;
  --text: #e6e6eb;
  --muted: #9a9aa1;

  --c-blue:  #e6eef8;
  --c-purple:#ede9f7;
  --c-orange:#f7eee4;
  --c-red:   #f7e6e6;
}

* {
  box-sizing: border-box;
}

body {
  margin: 40px;
  background: var(--bg);
  color: var(--text);
  font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI",
               Roboto, Helvetica, Arial, "PingFang SC", "Microsoft YaHei";
}

h1 {
  font-weight: 500;
  margin-bottom: 20px;
  letter-spacing: 0.5px;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: var(--panel);
  font-size: 13px;
}

th, td {
  border: 1px solid var(--grid);
  padding: 8px 10px;
  text-align: center;
  white-space: nowrap;
}

th {
  position: sticky;
  top: 0;
  background: #1f1f23;
  font-weight: 500;
  color: var(--muted);
}

td.left {
  text-align: left;
}

tr:hover td {
  background: rgba(255,255,255,0.03);
}

/* 评分色块 */
.score-blue   { background: var(--c-blue);   color: #1f2a44; }
.score-purple{ background: var(--c-purple); color: #2b2444; }
.score-orange{ background: var(--c-orange); color: #3a2a1a; }
.score-red   { background: var(--c-red);    color: #441e1e; }
</style>
</head>

<body>
<h1>饭店排名</h1>
<div id="table">加载中…</div>

<script>
fetch("饭店评分.xlsx")
  .then(r => r.arrayBuffer())
  .then(buf => {
    const wb = XLSX.read(buf, { type: "array" });
    const sheet = wb.Sheets[wb.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet);
    render(rows);
  })
  .catch(() => {
    document.getElementById("table").innerText =
      "未找到 data.xlsx";
  });

function scoreClass(v) {
  if (typeof v !== "number") return "";
  if (v >= 90) return "score-red";
  if (v >= 80) return "score-orange";
  if (v >= 70) return "score-purple";
  if (v >= 60) return "score-blue";
  return "";
}

function render(data) {
  if (!data.length) return;

  const table = document.createElement("table");
  const thead = document.createElement("thead");
  const tbody = document.createElement("tbody");

  const headers = Object.keys(data[0]);

  const hr = document.createElement("tr");
  headers.forEach(h => {
    const th = document.createElement("th");
    th.textContent = h;
    hr.appendChild(th);
  });
  thead.appendChild(hr);

  data.forEach(row => {
    const tr = document.createElement("tr");
    headers.forEach(key => {
      const td = document.createElement("td");
      const val = row[key];

      if (typeof val === "number") {
        td.className = scoreClass(val);
      }

      if (typeof val === "string" && val.length > 10) {
        td.classList.add("left");
      }

      td.textContent = val ?? "";
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });

  table.appendChild(thead);
  table.appendChild(tbody);

  const container = document.getElementById("table");
  container.innerHTML = "";
  container.appendChild(table);
}
</script>
</body>
</html>
